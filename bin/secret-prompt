#! /usr/bin/env bash
# Prompt for a secret. The secret is printed on stdout.
# Only tested with X

set -e

p=${1:-What is the secret?}
# The last grep in pipe causes command to fail if nothing is typed or
# cancel is pressed
cat <<EOF | pinentry -g | sed -n 's/^D //p' | grep .
SETPROMPT $p
GETPIN
EOF
